<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  body{margin:0;background:transparent;}

  .track{
    position:relative;
    width:100%;
    height:140px;
    overflow:hidden;
  }

  /* Debug stamp so we KNOW the file updated */
  .stamp{
    position:absolute;
    top:6px;
    left:8px;
    z-index:9999;
    font:12px/1.2 Inter, Arial, sans-serif;
    color:#d00;
    opacity:.9;
    user-select:none;
  }

  .error{
    position:absolute;
    top:28px;
    left:8px;
    right:8px;
    z-index:9999;
    font:12px/1.3 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
    color:#d00;
    background:rgba(255,0,0,.08);
    border:1px solid rgba(255,0,0,.25);
    padding:8px;
    border-radius:8px;
    white-space:pre-wrap;
    display:none;
  }

  .end{
    position:absolute;
    bottom:8px;
    font-size:28px;
    user-select:none;
  }
  .home{left:0;}
  .air{right:0;}

  .shuttle{
    position:absolute;
    bottom:12px;
    font-size:38px;
    z-index:3;
    user-select:none;
    will-change:left;
  }

  .trail{
    position:absolute;
    bottom:62px;   /* <- lowers/raises text */
    height:44px;
    overflow:hidden;
    z-index:2;
    pointer-events:none;
  }

  .trail span{
    display:block;
    white-space:nowrap;
    font-family:'Inter',sans-serif;
    font-size:22px;
    font-weight:400;
    letter-spacing:0.8px;
    text-transform:uppercase;

    color:black;
    -webkit-text-stroke:1.2px black;
    text-shadow:
      -1px -1px 0 #000,
       1px -1px 0 #000,
      -1px  1px 0 #000,
       1px  1px 0 #000;
  }
</style>
</head>
<body>

<div class="track" id="track">
  <div class="stamp">LOADED v9723</div>
  <div class="error" id="err"></div>

  <div class="trail" id="trail"><span id="text"></span></div>

  <div class="end home">üè†</div>
  <div class="end air">‚úàÔ∏è</div>

  <div class="shuttle" id="shuttle">üöê</div>
</div>

<script>
(function(){
  var errBox = document.getElementById("err");
  window.onerror = function(msg, src, line, col, error){
    errBox.style.display = "block";
    errBox.textContent =
      "JS ERROR:\n" +
      String(msg) + "\n" +
      (src ? ("Source: " + src + "\n") : "") +
      ("Line: " + line + " Col: " + col + "\n") +
      (error && error.stack ? ("\n" + error.stack) : "");
    return false;
  };

  var track   = document.getElementById("track");
  var shuttle = document.getElementById("shuttle");
  var trail   = document.getElementById("trail");
  var text    = document.getElementById("text");

  var lines = [
    "WELCOME TO TAPS SHUTTLES",
    "MATAMATA-PIAKO BASED SERVICE ‚Äî DOOR TO DOOR DIRECT",
    "HAMILTON AIRPORT ‚Üí TE AROHA FROM $110",
    "HAMILTON AIRPORT ‚Üí MORRINSVILLE FROM $110",
    "HAMILTON AIRPORT ‚Üí MATAMATA FROM $120",
    "TE AROHA ‚Üí AUCKLAND AIRPORT FROM $230",
    "SEE OUR SUPER DEALS FOR MORE LOCATIONS BELOW!! ‚úàÔ∏è"
  ];

  // TUNE
  var legMs   = 12000;
  var pauseMs = 350;
  var pad     = 40;
  var gap     = 12;

  var dir = 1;
  var idx = 0;
  var start = performance.now();
  var waitUntil = 0;
  var origin = null;

  text.textContent = lines[0];

  function ease(t){ return 0.5 - 0.5*Math.cos(Math.PI*t); }

  function setLine(i){
    idx = (i + lines.length) % lines.length;
    text.textContent = lines[idx];
    trail.style.width = "0px";
  }

  function loop(now){
    if(now < waitUntil){
      requestAnimationFrame(loop);
      return;
    }

    var trackW = track.clientWidth;
    var sW = shuttle.getBoundingClientRect().width || 40;

    var minX = pad;
    var maxX = Math.max(minX, trackW - sW - pad);

    var t = (now - start)/legMs;
    if(t > 1) t = 1;

    var p = ease(t);
    var travelT = (dir === 1) ? p : (1 - p);
    var x = minX + (maxX - minX) * travelT;

    shuttle.style.left = x + "px";

    var tr = track.getBoundingClientRect();
    var sr = shuttle.getBoundingClientRect();

    // capture per-leg origin once (pixel-synced from the first frame)
    if(origin === null){
      origin = (dir === 1)
        ? ((sr.left - tr.left) - gap)
        : ((sr.right - tr.left) + gap);
      trail.style.width = "0px";
    }

    if(dir === 1){
      var endX = (sr.left - tr.left) - gap;
      var w = Math.max(0, endX - origin);
      trail.style.left = origin + "px";
      trail.style.width = w + "px";
      trail.style.textAlign = "right";
    } else {
      var startX = (sr.right - tr.left) + gap;
      var w2 = Math.max(0, origin - startX);
      trail.style.left = startX + "px";
      trail.style.width = w2 + "px";
      trail.style.textAlign = "left";
    }

    if(t >= 1){
      dir *= -1;
      start = now;
      waitUntil = now + pauseMs;
      setLine(idx + 1);
      origin = null;
    }

    requestAnimationFrame(loop);
  }

  requestAnimationFrame(loop);
})();
</script>

</body>
</html>
