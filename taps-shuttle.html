<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400&display=swap" rel="stylesheet">

<style>
body{margin:0;background:transparent;}

/* ===================================== */
/* üö´ HIDE ENTIRE ANIMATION ON MOBILE */
/* ===================================== */
@media (max-width: 768px){
  body{
    display:none;
  }
}

/* ===================================== */
/* DESKTOP STYLES */
/* ===================================== */

.track{
  position:relative;
  width:100%;
  height:120px;
  overflow:hidden;
}

.shuttle{
  position:absolute;
  bottom:20px;
  font-size:40px;
  user-select:none;
  will-change:left, transform;
}

.trail{
  position:absolute;
  bottom:8px;
  height:40px;
  overflow:hidden;
  pointer-events:none;
}

.trail span{
  white-space:nowrap;
  font-family:'Inter',sans-serif;
  font-size:22px;
  letter-spacing:1px;
  text-transform:uppercase;
  color:black;
}

.home{
  position:absolute;
  left:0;
  bottom:20px;
  font-size:26px;
}

.air{
  position:absolute;
  right:0;
  bottom:20px;
  font-size:26px;
}
</style>
</head>
<body>

<div class="track" id="track">

  <div class="trail" id="trail">
    <span id="text"></span>
  </div>

  <div class="shuttle" id="shuttle">üöê</div>

  <div class="home">üè†</div>
  <div class="air">‚úàÔ∏è</div>

</div>

<script>
(function(){

var track = document.getElementById("track");
var shuttle = document.getElementById("shuttle");
var trail = document.getElementById("trail");
var text = document.getElementById("text");

var lines = [
  "WELCOME TO TAPS SHUTTLES",
  "MATAMATA-PIAKO BASED SERVICE ‚Äî DOOR TO DOOR DIRECT WAIKATO <--> AUCKLAND AIRPORT",
  "HAMILTON AIRPORT ‚Üí TE AROHA FROM $110",
  "HAMILTON AIRPORT ‚Üí MORRINSVILLE FROM $110",
  "HAMILTON AIRPORT ‚Üí MATAMATA FROM $120",
  "TE AROHA ‚Üí AUCKLAND AIRPORT FROM $230"
];

var legMs = 10000;
var pauseMs = 300;
var padding = 40;
var gap = 14;

var dir = 1;
var idx = 0;
var start = performance.now();
var waitUntil = 0;
var origin = null;

text.textContent = lines[0];

function ease(t){
  return 0.5 - 0.5*Math.cos(Math.PI*t);
}

function setLine(i){
  idx = (i + lines.length) % lines.length;
  text.textContent = lines[idx];
  trail.style.width = "0px";
}

function loop(now){

  if(now < waitUntil){
    requestAnimationFrame(loop);
    return;
  }

  var trackW = track.clientWidth;
  var shuttleW = shuttle.offsetWidth;

  var minX = padding;
  var maxX = trackW - shuttleW - padding;

  var t = (now - start)/legMs;
  if(t > 1) t = 1;

  var p = ease(t);
  var travelT = (dir === 1) ? p : (1 - p);
  var x = minX + (maxX - minX) * travelT;

  shuttle.style.left = x + "px";

  if(dir === 1){
    shuttle.style.transform = "scaleX(-1)";
  } else {
    shuttle.style.transform = "scaleX(1)";
  }

  var shuttleRect = shuttle.getBoundingClientRect();
  var trackRect = track.getBoundingClientRect();

  if(origin === null){
    origin = (dir === 1)
      ? (shuttleRect.left - trackRect.left - gap)
      : (shuttleRect.right - trackRect.left + gap);

    trail.style.width = "0px";
  }

  if(dir === 1){
    var endX = shuttleRect.left - trackRect.left - gap;
    var width = Math.max(0, endX - origin);
    trail.style.left = origin + "px";
    trail.style.width = width + "px";
    trail.style.textAlign = "right";
  } else {
    var startX = shuttleRect.right - trackRect.left + gap;
    var width2 = Math.max(0, origin - startX);
    trail.style.left = startX + "px";
    trail.style.width = width2 + "px";
    trail.style.textAlign = "left";
  }

  if(t >= 1){
    dir *= -1;
    start = now;
    waitUntil = now + pauseMs;
    setLine(idx + 1);
    origin = null;
  }

  requestAnimationFrame(loop);
}

requestAnimationFrame(loop);

})();
</script>

</body>
</html>
